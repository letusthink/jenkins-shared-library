#!groovy

//使用共享库
@Library('jenkins-shared-library@main') _

//调用函数
def tools = new org.color()
def checkout = new org.checkout()

pipeline {
    agent {
        kubernetes {
            retries 2
            yamlFile 'KubernetesPod.yaml'   
        }
    }
    options {
        skipDefaultCheckout true
    }

    stages{
    stage("GetCode"){
        steps{
            script{
                checkout scmGit(branches: [[name: "${env.branchName}"]], 
                    extensions: [], userRemoteConfigs: [[credentialsId: 'GitHub_SSH_Credentials', 
                    url: "${env.srcUrl}"]])
                sh "ls -l"
                }
            }        
        }
    }
}